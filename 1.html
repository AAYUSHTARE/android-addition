
import pandas as pd
import win32com.client as win32

# Sample DataFrame
data = {'Name': ['John', 'Alice', 'Bob'],
        'Age': [30, 25, 35]}
df = pd.DataFrame(data)

# Convert DataFrame to HTML with CSS styling for the table headers and font styling
html_table = df.style.set_table_styles([
    {'selector': 'th', 'props': [('color', 'red')]},  # Style for table headers
    {'selector': 'body', 'props': [('font-family', 'Arial')]}  # Style for text font
]).render()

# Text for the email body
email_text = """<span style="font-family: Arial;">Hello,<br><br>Please find the DataFrame below:<br><br></span>"""

# Combine text and HTML table
email_body = email_text + html_table

# Create the Outlook application object
outlook = win32.Dispatch('outlook.application')

# Create a new mail item
mail = outlook.CreateItem(0)
mail.Subject = 'DataFrame in Email Body'

# Set the HTML body of the email
mail.HTMLBody = f'<p>{email_body}</p>'

# Add recipients, attachments, etc. as needed
# mail.To = 'recipient@example.com'
# mail.Attachments.Add('path_to_excel_file.xlsx')

# Send the email
mail​⬤

